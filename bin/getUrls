#!/bin/bash

# Load environment variables from .env file
source .env

# Query to retrieve the base URL value
query="SELECT value FROM core_config_data WHERE path = 'web/unsecure/base_url'"

# Execute the query and retrieve the value
baseUrl=$(bin/cli mysql -h "$MARIADB_HOST" -u "$MARIADB_ROOT_USER" -p"$MARIADB_ROOT_PASSWORD" -D "$MARIADB_DATABASE" -se "$query")\

newBaseUrl="http://example.loc/"

updateQuery="UPDATE core_config_data SET value = '$newBaseUrl' WHERE value LIKE '%fem.loc%'"

if [[ -n "$baseUrl" ]]; then
  bin/cli mysql -h "$MARIADB_HOST" -u "$MARIADB_ROOT_USER" -p"$MARIADB_ROOT_PASSWORD" -D "$MARIADB_DATABASE" -se "$updateQuery"
  echo "Base URLs updated to: $newBaseUrl"
else
  echo "Base URL not found in the database."
fi
